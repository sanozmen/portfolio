<!DOCTYPE html>
<html>
<head>
    <meta charset=utf-8 />
    <title>Coronavirus Map </title>
    <!--metda data-->
    <meta name="description" content="coronavirus, corona, COVID-19, china, wuhan, virus, novel, new, map, interactive map, open source, death, infection, disease, outbreak, global map, spread, track, tracking, leaflet.js, dashboard, mapbox, arcgis, qgis, web map, GIS, graph, data "/>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-57534785-5"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
   
          gtag('config', 'UA-57534785-5');
      </script>
    <!--Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Spartan&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,700&display=swap" rel="stylesheet">
    <!--leaflet style-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
          integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
          crossorigin=""/>
    <!-- leaflet js. Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
            integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
            crossorigin=""></script>
    <!--sidebar style-->
    <link rel="stylesheet" href="assets/css/leaflet-sidebar.css" />
    <!--font awesome style-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/js/all.js" integrity="sha256-2JRzNxMJiS0aHOJjG+liqsEOuBb6++9cY4dSOyiijX4=" crossorigin="anonymous"></script>

    <!-- marker cluster styles-->
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.4/dist/MarkerCluster.Default.css">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.4/dist/MarkerCluster.css">
    <!-- bootstrap css-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <!--marker cluster javascript-->
    <script src="https://unpkg.com/leaflet.markercluster@1.0.4/dist/leaflet.markercluster.js"></script>
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
        .leaflet-tooltip-pane .text {
            color:black;
            /*-webkit-text-stroke: 0.03em white;*/
            font-weight: bold;
            background: transparent;
            border:0;
            box-shadow: none;
            font-size: 1em;
        }
        /*/////////////////// Icon pulse ////////////////*/
        .fa-pulse {
            display: inline-block;
            -moz-animation: pulse 2s infinite linear;
            -o-animation: pulse 2s infinite linear;
            -webkit-animation: pulse 2s infinite linear;
            animation: pulse 2s infinite linear;
        }
        @-webkit-keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        @-moz-keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        @-o-keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        @-ms-keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
        /*/////////////////End of Icon Pulse////////////////////*/
        .leaflet-popup-content {
            padding: 10px 10px 15px;
            margin: 0;
            line-height: inherit;
        }
        div.leaflet-popup-content-wrapper {
            background-color: rgb(47, 60, 66);
            color: white;
            font-size: 12px;
            font-family:'Ubuntu', sans-serif;
            border-radius: 3px;
            box-shadow: 0 1px 2px rgba(0,0,0,.1);
            padding: 1px;
            text-align: left;
            pointer-events: all;
        }
        .leaflet-sidebar-header {
            font-size: 15px;
        }
        /*This part is for avoiding overlap in sidebar and layer control in smaller
        screens  */
        @media (max-width: 769px) {
            .leaflet-sidebar-header {
                font-size: 13px;
            }
        }
        @media (max-width: 769px) {
            .leaflet-sidebar-content {
                opacity: 0.95 ;
            }
        }
        @media (max-width: 769px) {
            .leaflet-right .leaflet-control {
                margin-right: 60px;
            }
        }

        .leaflet-sidebar-header {
            background-color:rgb(47, 60, 66);

        }
        .leaflet-sidebar-header p{
            margin-bottom: 0px;
            margin-top: 0px;
        }
        .leaflet-sidebar-tabs > li.active, .leaflet-sidebar-tabs > ul > li.active {
            background-color:rgb(47, 60, 66);
        }

        .info {
            padding: 6px 8px;
            font-size: 13px;
            background: white;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        .info h4 {
            margin: 0 0 5px;
            color: #777;
        }
        .legend {
            text-align: left;
            line-height: 30px;
            color: #555;
            width: auto;
        }
        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }
        .legend .colorcircle {
            border-radius: 50%;
            width: 15px;
            height: 15px;
            margin-top: 0px;
        }
        .legend .circlepadding {
            border-radius: 50%;
            margin-top: 0px;
            background: rgba(255, 255, 255, 0.8);
        }

        .highcharts-data-table table {
            font-family: Verdana, sans-serif;
            border-collapse: collapse;
            border: 1px solid #EBEBEB;
            margin: 10px auto;
            text-align: center;
            width: 100%;
            max-width: 500px;
        }
        .highcharts-data-table caption {
            padding: 1em 0;
            font-size: 1.2em;
            color: #555;
        }
        .highcharts-data-table th {
            font-weight: 600;
            padding: 0.5em;
        }
        .highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
            padding: 0.5em;
        }
        .highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
            background: #f8f8f8;
        }
        .highcharts-data-table tr:hover {
            background: #f1f7ff;
        }
        .upperInfo {
            background: rgb(243, 238, 163);
            border-radius: 7px;
        }
        .upperInfo2 {
            background: rgb(243, 238, 163);
            border-radius: 7px;
        }
        h5 {
            width:100%;
            margin-top:10px;
            font-family:'Ubuntu', sans-serif;
            padding:0.4em;
        }
        .firstEverInfo{
            background: rgb(241, 203, 159);
            border-radius: 7px;
        }
        .firstDeathsInfo{
            background: rgb(236, 135, 104);
            border-radius: 7px;
        }
        h6 {
            width:100%;
            margin-top:10px;
            font-family:'Ubuntu', sans-serif;
            padding:0.4em;
        }
        .percentConfirmed{
            background: rgb(241, 203, 159);
            border-radius: 7px;
        }
        .Increase{
            background: rgb(241, 203, 159);
            border-radius: 7px;
        }
        .Increase2{
            background: rgb(236, 135, 104);
            border-radius: 7px;
        }
        .percentDeath{
            background: rgb(236, 135, 104);
            border-radius: 7px;
        }
        .firstRecoveredInfo{
            background: rgb(148, 194, 231);
            border-radius: 7px;
        }
        .percentRecoveredInfo{
            background: rgb(148, 194, 231);
            border-radius: 7px;
        }

        .RecoveredInfo{
            background: rgb(148, 194, 231);
            border-radius: 7px;
        }
        #sidebar > div.leaflet-sidebar-tabs > ul:nth-child(1) > li.active > a > span {
            margin-top: 10px;
        }
        #sidebar > div.leaflet-sidebar-tabs > ul:nth-child(1) > li:nth-child(1) > a > span {
            margin-top: 10px;
        }

        @media (max-width: 769px) {
            h6 {
                font-size: 15px;
            }
        }
        @media (max-width: 769px) {
            h5 {
                font-size: 18px;
            }
        }
        .leaflet-container a {
    color: #000;
}

    </style>
</head>
<body>
<!-- SIDEBAR STARTS HERE-->
<div id="sidebar" class="leaflet-sidebar collapsed">
    <!-- Nav tabs -->
    <div class="leaflet-sidebar-tabs">
        <ul role="tablist">
            <li><a href="#home" role="tab"><span class="fas fa-caret-right"></span></a></li>
            <li><a href="index.html" role="tab"><img src="images/logo.svg" style="width: 20px; height: 20px;" alt="" /></i></a></li>
            <!-- <li class="disabled"><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li> -->
        </ul>
        <ul role="tablist">
            <li><a href="https://github.com/sanozmen/" role="tab" target="_blank"><i class="fab fa-github fa-lg"></i></a></li>
        </ul>
        <!--<ul role="tablist">
            <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
        </ul> -->
    </div>
    <!-- Tab panes. -->
    <div class="leaflet-sidebar-content">
        <div class="leaflet-sidebar-pane" id="home">
            <h1 class="leaflet-sidebar-header">
                <p ><b>Click and Hide the Pane</b></p>
                <span class="leaflet-sidebar-close"><p class="fa-pulse">X</p></span>
            </h1>
            <p class="lorem" style="margin-top:20px">Click either "X" on top left corner or  <i class="fas fa-caret-right"></i> symbol on top right corner to hide the pane and see the map.</p>

            <h4 style="margin-bottom:10px; font-family:'Ubuntu', sans-serif; font-weight: bold;">Global Coronavirus Map</br>1 March 2020</h4>
            <a class="btn btn-warning" href="index.html" style="width: 100%;" role="button" target="_blank" >Click to return to the Current Situation</a>

            <div class="upperInfo">
                <h6 id="dataDate"></h6>
                <h5 id="totalConfirmed"></h5>
                <h5 id="totalDeaths"></h5>
                <h5 id="totalRecovered"></h5>
            </div>

            <div id="containerLineConfirmed" style="width:100%; height:500px;"></div>
            <p style="margin-top:30px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >In order to see the graph in full screen you can click the symbol <i class="fa fa-bars"></i>
                on top right corner (not possible for mobile devices) of the graph. Hovering over the name of the country in the legend will highlight its line on the graph. To select countries of interest and switch on/off others click on country names shown in the legend. </p>
            <div class="Increase" >
                <h6 id="caseIncrease"></h6>
            </div>

            <div class="firstEverInfo">
                <h6 id="firstCases"></h6>
            </div>

            <div class="percentConfirmed">
                <h6 id="topFive"></h6>
            </div>
            <div class="percentConfirmed">
                <h6 id="fastestConfirmed"></h6>
            </div>
            <div id="containerLineDeaths" style="width:100%; height:500px;"></div>
            <p style="margin-top:30px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >In order to see the graph in full screen you can click the symbol <i class="fa fa-bars"></i> on top right corner
                (not possible for mobile devices) of the graph. Hovering over the name of the country in the legend will highlight its line on the graph. To select countries of interest and switch on/off others click on country names shown in the legend. </p>
            <div class="Increase2" >
                <h6 id="deathIncrease"></h6>
            </div>

            <div class="firstDeathsInfo">
                <h6 id="firstDeath"></h6>
            </div>

            <div class="percentDeath">
                <h6 id="topFiveDeath"></h6>
            </div>



            <div id="containerLineRecovered" style="width:100%; height:500px;"></div>
            <p style="margin-top:30px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >In order to see the graph in full screen you can click the symbol <i class="fa fa-bars"></i>
                on top right corner (not possible for mobile devices) of the graph. Hovering over the name of the country in the legend will highlight its line on the graph. To select countries of interest and switch on/off others click on country names shown in the legend. </p>

            <div class="RecoveredInfo">
                <h6 id="recoveredIncrease"></h6>
            </div>
            <div class="firstRecoveredInfo">
                <h6 id="firstRecovered"></h6>
            </div>
            <div class="percentRecoveredInfo">
                <h6 id="topFiveRecovered"></h6>
            </div>




            <p style="margin-top:30px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >This interactive world map aims to track the global spread of 2019 Novel Coronavirus
                (COVID-19) outbreak, inspired by <a href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6"
                                                    target="_blank"> this popular map</a> produced by researchers at Johns Hopkins CSSE. <a href="https://github.com/CSSEGISandData/COVID-19" target="_blank">
                    Daily updated data </a> is also provided by John Hopkin's researchers.</p>
            <p style="margin-top:30px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >There are 3 different layers. First "Confirmed Cases"
                shows the cumulative number of infected individuals at those locations. Second one "Deaths" indicates cumulative number of deaths caused by
                this disease. Lastly, the layer "Recover" denotes
                the cumulative number of persons who got recovered. </p>
            <h6 style="background: none;">How to use the map</h6>
            <p style="margin-top:10px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >Labels inside the circles represents the cumulative number of persons. Click on radio-buttons on top-right corner to switch between layers. In order to open popup windows
                with more details such as name of location, date of data. </p>
            <div id="containerBarConfirmed" style="width:100%; height:1500px;"></div>
            <div id="containerBarDeaths" style="width:100%; height:500px;"></div>
            <div id="containerBarRecovered" style="width:100%; height:750px;"></div>
            <p style="margin-top:10px; font-family:'Ubuntu', sans-serif; line-height: 20px" align=justify >contact:s.sanozmen@hotmail.com</p>
            <p style="margin-top:130px; font-family:'Ubuntu' ,sans-serif; font-size:10px; line-height: 10px" align=justify >
                tags: coronavirus, corona, COVID-19, china, novel, new, map, interactive map, infection, disease, outbreak, global map, spread, track, people, sick, death</p>
        </div>
        <div class="leaflet-sidebar-pane" id="profile">
            <h1 class="leaflet-sidebar-header">Profile<span class="leaflet-sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
        </div>
        <div class="leaflet-sidebar-pane" id="messages">
            <h1 class="leaflet-sidebar-header">Messages<span class="leaflet-sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
        </div>
        <div class="leaflet-sidebar-pane" id="settings">
            <h1 class="leaflet-sidebar-header">Settings<span class="leaflet-sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
        </div>
    </div>
</div>
<div id='map'></div>
<!--Side bar javascript file-->
<script src="assets/js/leaflet-sidebar.js"></script>
<!--Highcharts-->
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/annotations.js"></script>
<script src="https://code.highcharts.com/modules/series-label.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<!--Jquery-->
<script
        src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
        crossorigin="anonymous"></script>
<!-- below is for bootstrap -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<!-- for titling the layer groups-->
<script src="https://rawgithub.com/ismyrnow/Leaflet.groupedlayercontrol/master/src/leaflet.groupedlayercontrol.js"></script>
<!--Leaflet mapbox omnivore plugin for reading various formats including csv-->
<script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.2.0/leaflet-omnivore.min.js'></script>
<!--CSV parser Papa parse-->
<script src="assets/js/papaparse.min.js"></script>
<script>
    window.onload= function () {
        /*various options for the basemap*/
        let grayscale = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        });
        let CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        });
        let Stadia_AlidadeSmoothDark = L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png', {
            maxZoom: 20,
            attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
        });
        let CartoDB_Voyager = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        });
        let map = L.map('map', {
            zoom: 4,
            center: [39.92,25.85],
            layers: [grayscale]
        });

        let myRenderer = L.canvas({ padding: 0.1 });
        /* Defining icons in different shapes and colors for different layers*/
        let smallMedium_icon = {
            radius: 8,
            fillColor: "#feb24c",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };

        let medium_icon = {
            radius: 10,
            fillColor: "#fc4e2a",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        let mediumLarge_icon = {
            radius: 14,
            fillColor: "#e31a1c",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        let large_icon = {
            radius: 18,
            fillColor: "#bd0026",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };

        let small_icon_d = {
            radius: 10,
            fillColor: "#fcc5c0",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        let medium_icon_d = {
            radius: 14,
            fillColor: "#f768a1",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        let large_icon_d = {
            radius: 18,
            fillColor: "#ae017e",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };

        let small_icon_r = {
            radius: 10,
            fillColor: "#7fcdbb",
            color: "000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };

        let medium_icon_r = {
            radius: 14,
            fillColor: "#1d91c0",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        let large_icon_r = {
            radius: 18,
            fillColor: "#225ea8",
            color: "#000",
            weight: 0.2,
            opacity: 1,
            fillOpacity: 0.8,
            renderer: myRenderer
        };
        /* end of marker style (icon) definitions*/
        /*utilizing date functionality in js
       in order to autmatically update data*/
        let d = new Date();
        let year=d.getFullYear();
        year=year-2000;
        let month=d.getMonth();
        month=month+1;
        let day=d.getDate();
        /*if current day's data has not been
        uploaded check yesterday. And if yesterday's data has also not been
        uploade check the day before yesterday (tDB_yesterday)*/
        let yesterday=day-1;
        let tDb_Yesterday=day-2;
        /*part below written to re-assign month, yesterday and tDb_Yesterday
        variable with new value if current day is the first day of the month*/
        function firstDayOfTheMonth(){
            if (day==1 && month==1){
                tDb_Yesterday=30;
                yesterday=31;
                month=12
            }
            else if (day==1 && month==2){
                tDb_Yesterday=30;
                yesterday=31;
                month=1
            }
            else if (day==1 && month==3){
                tDb_Yesterday=28;
                yesterday=29;
                month=2
            }
            else if (day==1 && month==4){
                tDb_Yesterday=30;
                day=NaN;
                yesterday=31;
                month=3
            }
            else if (day==1 && month==5){
                tDb_Yesterday=29;
                yesterday=30;
                month=4
            }
            else if (day==1 && month==6){
                tDb_Yesterday=30;
                yesterday=31;
                month=5
            }
            else if (day==1 && month==7){
                tDb_Yesterday=29;
                yesterday=30;
                month=6
            }
            else if (day==1 && month==8){
                tDb_Yesterday=30;
                yesterday=31;
                month=7
            }
            else if (day==1 && month==9){
                tDb_Yesterday=30;
                yesterday=31;
                month=8
            }
            else if (day==1 && month==10){
                tDb_Yesterday=29;
                yesterday=30;
                month=9
            }
            else if (day==1 && month==11){
                tDb_Yesterday=30;
                yesterday=31;
                month=10
            }
            else if (day==1 && month==12){
                tDb_Yesterday=29;
                yesterday=30;
                month=11
            }
        }
        
        /*call the function*/
        firstDayOfTheMonth();

        
        /* string arguments to be used in geojson templates before using them as arguments for
       csv omnivore plugin*/
        let todayString=3+"/"+1+"/"+year;
        

        let country="Country/Region";
        /* first one, confirmed cases geojson custom layer*/
        let confirmedLayer = L.geoJson(null, {
            filter: function() {
                // no custom filter function but still keeping it
                return true;
            },
            /*points to the layer with the latest day's data from the csv*/
            pointToLayer (feature, layer) {
                if (feature.properties[todayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic"){
                    if (feature.properties[todayString]<1000 && feature.properties[todayString]!=0 ){
                        return L.circleMarker(layer, smallMedium_icon)
                    }
                    else if (feature.properties[todayString]>=1000 && feature.properties[todayString]<5000){
                        return L.circleMarker(layer,medium_icon)
                    }
                    else if (feature.properties[todayString]>=5000 && feature.properties[todayString]<10000){
                        return L.circleMarker(layer,mediumLarge_icon)
                    }
                    else if (feature.properties[todayString]>=10000){
                        return L.circleMarker(layer,large_icon)
                    }
                } else if (feature.properties[yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic") {
                    if (feature.properties[yesterdayString]<1000 && feature.properties[yesterdayString]!=0 ){
                        return L.circleMarker(layer, smallMedium_icon)
                    }
                    else if (feature.properties[yesterdayString]>=1000 && feature.properties[yesterdayString]<5000){
                        return L.circleMarker(layer,medium_icon)
                    }
                    else if (feature.properties[yesterdayString]>=5000 && feature.properties[yesterdayString]<10000){
                        return L.circleMarker(layer,mediumLarge_icon)
                    }
                    else if (feature.properties[yesterdayString]>=10000){
                        return L.circleMarker(layer,large_icon)
                    }
                }
                else if (feature.properties[tDb_yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic") {
                    if (feature.properties[tDb_yesterdayString]<100 && feature.properties[tDb_yesterdayString]!=0){
                        return L.circleMarker(layer, smallMedium_icon)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=1000 && feature.properties[tDb_yesterdayString]<5000){
                        return L.circleMarker(layer,medium_icon)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=5000 && feature.properties[tDb_yesterdayString]<10000){
                        return L.circleMarker(layer,mediumLarge_icon)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=10000){
                        return L.circleMarker(layer,large_icon)
                    }
                }

            },
            onEachFeature (feature, layer) {
                /*popup content*/
                if (feature.properties[todayString]){
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Confirmed Cases: </b>"+feature.properties[todayString]+"<br>"+ "<b>Data Date: </b>"+[todayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[todayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else if (feature.properties[yesterdayString]){
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Confirmed Cases: </b>"+feature.properties[yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else {
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Confirmed Cases: </b>"+feature.properties[tDb_yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[tDb_yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[tDb_yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }

            },

        });
        /*deaths custom geojson layer*/
        let deathsLayer = L.geoJson(null, {
            filter: function() {
                // no custom filter function but still keeping it
                return true;
            },
            pointToLayer (feature, layer) {
                /*points to the layer with the latest day's data from the csv*/
                if (feature.properties[todayString] &&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic"){
                    if (feature.properties[todayString]<50 && feature.properties[todayString]!=0){
                        return L.circleMarker(layer, small_icon_d)
                    }
                    else if (feature.properties[todayString]>=50 && feature.properties[todayString]<500){
                        return L.circleMarker(layer,medium_icon_d)
                    }
                    else if (feature.properties[todayString]>=500){
                        return L.circleMarker(layer,large_icon_d)
                    }
                } else if (feature.properties[yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic") {
                    if (feature.properties[yesterdayString]<50 && feature.properties[yesterdayString]!=0 ){
                        return L.circleMarker(layer, small_icon_d)
                    }
                    else if (feature.properties[yesterdayString]>=50 && feature.properties[yesterdayString]<500){
                        return L.circleMarker(layer,medium_icon_d)
                    }
                    else if (feature.properties[yesterdayString]>=500){
                        return L.circleMarker(layer,large_icon_d)
                    }
                }
                else if (feature.properties[tDb_yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic"){
                    if (feature.properties[tDb_yesterdayString]<50 && feature.properties[tDb_yesterdayString]!=0 ){
                        return L.circleMarker(layer, small_icon_d)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=50 && feature.properties[tDb_yesterdayString]<500){
                        return L.circleMarker(layer,medium_icon_d)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=500){
                        return L.circleMarker(layer,large_icon_d)
                    }
                }
            },
            onEachFeature (feature, layer) {
                /*popup content*/
                if (feature.properties[todayString]){
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Deaths: </b>"+feature.properties[todayString]+"<br>"+ "<b>Data Date: </b>"+[todayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[todayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else if (feature.properties[yesterdayString]){
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Deaths: </b>"+feature.properties[yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else {
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Deaths: </b>"+feature.properties[tDb_yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[tDb_yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[tDb_yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }

            },
        });

        /*recovered, custom geojson layer*/
        let recoveredLayer= L.geoJson(null, {
            filter: function() {
                // no custom filter function but still keeping it
                return true;
            },
            pointToLayer (feature, layer) {
                /*points to the layer with the latest day's data from the csv*/
                if (feature.properties[todayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic"){
                    if (feature.properties[todayString]<1000 && feature.properties[todayString]!=0){
                        return L.circleMarker(layer, small_icon_r)
                    }
                    else if (feature.properties[todayString]>=1000 && feature.properties[todayString]<2000){
                        return L.circleMarker(layer,medium_icon_r)
                    }
                    else if (feature.properties[todayString]>=2000){
                        return L.circleMarker(layer,large_icon_r)
                    }
                } else if (feature.properties[yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic") {
                    if (feature.properties[yesterdayString]<1000 && feature.properties[yesterdayString]!=0){
                        return L.circleMarker(layer, small_icon_r)
                    }
                    else if (feature.properties[yesterdayString]>=1000 && feature.properties[yesterdayString]<2000){
                        return L.circleMarker(layer,medium_icon_r)
                    }
                    else if (feature.properties[yesterdayString]>=2000){
                        return L.circleMarker(layer,large_icon_r)
                    }
                }
                else if (feature.properties[tDb_yesterdayString]&&feature.properties[country]!="Iran (Islamic Republic of)" && feature.properties[country]!="Mainland China"&&feature.properties[country]!="Republic of Korea"&&feature.properties[country]!="Czech Republic") {
                    if (feature.properties[tDb_yesterdayString]<1000 && feature.properties[tDb_yesterdayString]!=0){
                        return L.circleMarker(layer, small_icon_r)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=1000 && feature.properties[tDb_yesterdayString]<2000){
                        return L.circleMarker(layer,medium_icon_r)
                    }
                    else if (feature.properties[tDb_yesterdayString]>=2000){
                        return L.circleMarker(layer,large_icon_r)
                    }
                }
            },
            onEachFeature (feature, layer) {
                /*popup content*/
                if (feature.properties[todayString]){
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Recovered: </b>"+feature.properties[todayString]+"<br>"+ "<b>Data Date: </b>"+[todayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[todayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else if (feature.properties[yesterdayString]){
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Recovered: </b>"+feature.properties[yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }
                else {
                    /*popup content*/
                    let content =  "<b>Country/Region: </b>"+feature.properties[country]+"<br>"+"<b>Province/State: </b>"+feature.properties["Province/State"]+"<br>"+ "<b>Recovered: </b>"+feature.properties[tDb_yesterdayString]+"<br>"+ "<b>Data Date: </b>"+[tDb_yesterdayString];
                    layer.bindPopup(content,{closeButton: false, offset:L.point(0,-5) });
                    /* for labels inside circles*/
                    let text = L.tooltip({
                        permanent: true,
                        direction: 'center',
                        className: 'text'
                    })
                        .setContent(feature.properties[tDb_yesterdayString])
                        .setLatLng(layer.getLatLng());
                    layer.bindTooltip(text)
                }

            },
        });
        /*csv resources called and assigned to a variable*/
        let confirmed= omnivore.csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv',null,confirmedLayer);
        let deaths= omnivore.csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv',null,deathsLayer);
        let recovered= omnivore.csv('https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv',null,recoveredLayer);
        confirmed.addTo(map);
        let baseLayers = {
            //not any baselayers
        };
        //grouping overlaying features
        let overlayElements = {
            "Coronavirus": {
                "Confirmed Cases": confirmed,
                "Deaths": deaths,
                "Recovered": recovered
            }
        };
        let options = {
            // Make the "Coronavirus" group exclusive (to use radio inputs)
            exclusiveGroups: ["Coronavirus"],
            // Show a checkbox next to non-exclusive group labels for toggling all
            groupCheckboxes: true,
            collapsed: false
        };
        L.control.groupedLayers(baseLayers, overlayElements, options).addTo(map);
        //colors to be used as palette for coloring the legend of confirmed layers
        function getColorConfirmed(y) {
            return y ==500 ? '#bd0026' :
                y ==400 ? '#e31a1c' :
                    y==300 ? '#fc4e2a' :
                        y==200 ? '#feb24c' :
                            '#D04030';
        }
        //colors to be used as palette for coloring the legend of deaths layer
        function getColorDeaths(y) {
            return y==300 ? '#ae017e' :
                y==200 ? '#f768a1' :
                    y==100 ? '#fcc5c0' :
                        '#D04030';
        }
        //colors to be used as palette for coloring the legend of recovered layer
        function getColorRecovered(y) {
            return y==300 ? '#225ea8' :
                y==200 ? '#1d91c0' :
                    y==100 ? '#7fcdbb' :
                        '#D04030';
        }

        //calculate radius so that resulting circles will be proportional by area
        function getRadius(y) {
            r = Math.sqrt(y / Math.PI);
            return r;
        }
        //defining legends
        let confirmedLegend= L.control({position: 'bottomleft'});
        let deathsLegend= L.control({position: 'bottomleft'});
        let recoveredLegend= L.control({position: 'bottomleft'});
        //creating all legends
        confirmedLegend.onAdd = function (map) {
            let div = L.DomUtil.create('div', 'info legend'),
                grades = [200, 300,400,500],
                labels2=[0,1000,5000,10000],
                labels = ['<strong>Legend</strong>', "Confirmed Cases"],
                from, to;
            //iterate through grades and create a color field and label for each
            for (let i = 0; i < grades.length; i++) {
                from = grades[i];
                to = grades[i + 1];
                labels.push( '<i class="circlepadding" style="width: '+Math.max(0,(40-1.8*getRadius(from)))+'px;"></i> <i style="background:'+ getColorConfirmed(from)+'; width: '+getRadius(from)*2+'px; height: '+getRadius(from)*2+'px; border-radius: 50%; margin-top: '+Math.max(0,(9-getRadius(from)))+'px;"></i> ' + labels2[i]+(labels2[i+1] ? '&ndash;' + labels2[i+1] : '+'));
            }
            div.innerHTML = labels.join('<br>');
            return div;
        };

        deathsLegend.onAdd = function (map) {
            let div = L.DomUtil.create('div', 'info legend'),
                grades = [100, 200, 300],
                labels2=[0,50,500],
                labels = ['<strong>Legend</strong>', "Deaths"],
                from, to;
            //iterate through grades and create a color field and label for each
            for (let i = 0; i < grades.length; i++) {
                from = grades[i];
                to = grades[i + 1];
                labels.push( '<i class="circlepadding" style="width: '+Math.max(0,(40-1.8*getRadius(from)))+'px;"></i> <i style="background:'+ getColorDeaths(from)+'; width: '+getRadius(from)*2+'px; height: '+getRadius(from)*2+'px; border-radius: 50%; margin-top: '+Math.max(0,(9-getRadius(from)))+'px;"></i> ' + labels2[i]+(labels2[i+1] ? '&ndash;' + labels2[i+1] : '+'));
            }
            div.innerHTML = labels.join('<br>');
            return div;

        };
        recoveredLegend.onAdd = function (map) {

            let div = L.DomUtil.create('div', 'info legend'),
                grades = [100, 200, 300],
                labels2=[0,1000,2000],
                labels = ['<strong>Legend</strong>', "Recovered"],
                from, to;
            //iterate through grades and create a color field and label for each
            for (let i = 0; i < grades.length; i++) {
                from = grades[i];
                to = grades[i + 1];
                labels.push( '<i class="circlepadding" style="width: '+Math.max(0,(40-1.8*getRadius(from)))+'px;"></i> <i style="background:'+ getColorRecovered(from)+'; width: '+getRadius(from)*2+'px; height: '+getRadius(from)*2+'px; border-radius: 50%; margin-top: '+Math.max(0,(9-getRadius(from)))+'px;"></i> ' + labels2[i]+(labels2[i+1] ? '&ndash;' + labels2[i+1] : '+'));
            }
            div.innerHTML = labels.join('<br>');
            return div;

        };
        //initally add first layer's legend on the main page as default
        confirmedLegend.addTo(map);
        //conditional add/remove of legends
        confirmed.beforeAdd = function (map) {
            confirmedLegend.addTo(map);
            deathsLegend.remove(map);
            recoveredLegend.remove(map);
        };
        deaths.beforeAdd = function (map) {
            deathsLegend.addTo(map);
            confirmedLegend.remove(map);
            recoveredLegend.remove(map);
        };
        recovered.beforeAdd=function(map){
            deathsLegend.remove(map);
            confirmedLegend.remove(map);
            recoveredLegend.addTo(map);
        };
        //adding the side bar to the window
        let sidebar = L.control.sidebar({ container: 'sidebar', position: 'right' })
            .addTo(map)
            .open("home");

        //GRAPH, DATA OPERATIONS for Confirmed
        let timeSeriesConfirmedLabels=[]
        let worldTotal_Confirmed=0;
        let confirmedLabels=[];
        let confirmedValues=[];
        //states and overseas variable is mainly required to avoid calculation mistakes for countries like UK,NL,FR
        let confirmedLabels_StatesAndOverseas=[];
        let confirmedValues_StatesAndOverseas=[];
        let confirmedValues_StatesAndOverseas_OneDayAgo=[];
        let confirmedValues_OneDayAgo=[];
        //time series to be used in line graph visualisation
        let timeSeriesConfirmed_US=[]
        let timeSeriesConfirmed_Australia=[]
        let timeSeriesConfirmed_Canada=[]
        let timeSeriesConfirmed_China=[]
        let timeSeriesConfirmed_Iran=[]
        let timeSeriesConfirmed_Italy=[]
        let timeSeriesConfirmed_Spain=[]
        let timeSeriesConfirmed_Turkey=[]
        let timeSeriesConfirmed_UK=[]
        let timeSeriesConfirmed_Germany=[]
        let timeSeriesConfirmed_France=[]
        let timeSeriesConfirmed_Switzerland=[]
        let timeSeriesConfirmed_SouthKorea=[]
        let timeSeriesConfirmed_Japan=[]
        let timeSeriesConfirmed_Czechia=[]
        let timeSeriesConfirmed_NL=[]
        //In order to find total cases in US,China,Canada and Australia, whose data is presented separately for states
        let totalConfirmed_US=0;
        let totalConfirmed_China=0;
        let totalConfirmed_Canada=0;
        let totalConfirmed_Aus=0;
        //in order to find daily change %
        let totalConfirmed_US_OneDayAgo=0;
        let totalConfirmed_China_OneDayAgo=0;
        let totalConfirmed_Canada_OneDayAgo=0;
        let totalConfirmed_Aus_OneDayAgo=0;
        //putting confirmed cases into array format, into the empty arrays defined above
        Papa.parse("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv", {
            download: true,
            dynamicTyping: true,
            complete: function(results) {
                //select the latest column
                let lastCol=43;
                //getting the header of the last column to use as date info in the app
                let lastColHeader=results.data[0][lastCol]

                document.getElementById("dataDate").innerHTML="<b>Data Date:</b> "+lastColHeader
                //select the column before the latest to use its data in daily % change calc
                let last2Col=42;
                timeSeriesConfirmedLabels.push((results.data[0]).slice(4,lastCol+1))
                console.log(timeSeriesConfirmedLabels)
                //find the row where country name is either "US","China","Canada" or "Australia"
                //and add the corresponding value to the total sum of that country
                for (i=1; i< results.data.length-1; i++) {
                    if (results.data[i][1]=="US"){
                        confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        
                        timeSeriesConfirmed_US.push((results.data[i].slice(4,lastCol+1)))
                        console.log(timeSeriesConfirmed_US)
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalConfirmed_US=totalConfirmed_US + nmbr
                        totalConfirmed_US_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="China"){
                        confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesConfirmed_China.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalConfirmed_China=totalConfirmed_China + nmbr
                        totalConfirmed_China_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Canada"){
                        confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesConfirmed_Canada.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalConfirmed_Canada=totalConfirmed_Canada + nmbr
                        totalConfirmed_Canada_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Australia"){
                        confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesConfirmed_Australia.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalConfirmed_Aus=totalConfirmed_Aus + nmbr
                        totalConfirmed_Aus_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]==="France"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            confirmedLabels_StatesAndOverseas.push(results.data[i][1])
                            confirmedLabels.push(results.data[i][1])
                            timeSeriesConfirmed_France.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            confirmedLabels.push(results.data[i][0])
                            confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        confirmedValues.push(nmbr);
                        confirmedValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Netherlands"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            confirmedLabels_StatesAndOverseas.push(results.data[i][1])
                            confirmedLabels.push(results.data[i][1])
                            timeSeriesConfirmed_NL.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            confirmedLabels.push(results.data[i][0])
                            confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        confirmedValues.push(nmbr);
                        confirmedValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="United Kingdom"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            confirmedLabels_StatesAndOverseas.push(results.data[i][1])
                            confirmedLabels.push(results.data[i][1])
                            timeSeriesConfirmed_UK.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            confirmedLabels.push(results.data[i][0])
                            confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        confirmedValues.push(nmbr);
                        confirmedValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Denmark"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            confirmedLabels_StatesAndOverseas.push(results.data[i][1])
                            confirmedLabels.push(results.data[i][1])
                        } else {
                            confirmedLabels.push(results.data[i][0])
                            confirmedLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        confirmedValues.push(nmbr);
                        confirmedValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                        //except US,China,Canada and Australia. Push the country name to the labels list
                    //and push the corresponding value to the values list
                    else if (results.data[i][1]!="US" || results.data[i][1]!="Mainland China"|| results.data[i][1]!="China"
                        || results.data[i][1]!="Canada" || results.data[i][1]!="Australia" || results.data[i][1]!="Denmark" || results.data[i][1]!="France" || results.data[i][1]!="United Kingdom" ||
                        results.data[i][1]!="Netherlands" ){
                        confirmedLabels_StatesAndOverseas.push(results.data[i][1])
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        let nmbr=results.data[i][lastCol];
                        confirmedValues_StatesAndOverseas.push(nmbr)
                        confirmedValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        confirmedValues.push(nmbr);
                        confirmedLabels.push(results.data[i][1])
                        confirmedValues_OneDayAgo.push(nmbr_OneDayAgo)
                        if (results.data[i][1]=="Turkey") {
                            timeSeriesConfirmed_Turkey.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Germany") {
                            timeSeriesConfirmed_Germany.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Korea, South") {
                            timeSeriesConfirmed_SouthKorea.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Spain") {
                            timeSeriesConfirmed_Spain.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Italy") {
                            timeSeriesConfirmed_Italy.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Iran") {
                            timeSeriesConfirmed_Iran.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Switzerland") {
                            timeSeriesConfirmed_Switzerland.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Czechia") {
                            timeSeriesConfirmed_Czechia.push(results.data[i].slice(4,lastCol+1))
                        }

                    }
                    else {
                        console.log("ERROR")
                    }
                }
                confirmedLabels.push("US","China","Canada","Australia");
                confirmedValues.push(totalConfirmed_US,totalConfirmed_China, totalConfirmed_Canada, totalConfirmed_Aus);
                confirmedValues_OneDayAgo.push(totalConfirmed_US_OneDayAgo,totalConfirmed_China_OneDayAgo,totalConfirmed_Canada_OneDayAgo,totalConfirmed_Aus_OneDayAgo)
                timeSeriesConfirmed_US_Total=[]
              
                for (i=0;i<timeSeriesConfirmed_US[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesConfirmed_US.length;n++) {
                        column+=timeSeriesConfirmed_US[n][i]
                    }
                    timeSeriesConfirmed_US_Total.push(column)
                }
                console.log(timeSeriesConfirmed_Czechia)
                console.log(timeSeriesConfirmed_US_Total)
            
                timeSeriesConfirmed_Canada_Total=[]
                for (i=0;i<timeSeriesConfirmed_Canada[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesConfirmed_Canada.length;n++) {
                        column+=timeSeriesConfirmed_Canada[n][i]
                    }
                    timeSeriesConfirmed_Canada_Total.push(column)
                }
                timeSeriesConfirmed_Australia_Total=[]
                for (i=0;i<timeSeriesConfirmed_Australia[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesConfirmed_Australia.length;n++) {
                        column+=timeSeriesConfirmed_Australia[n][i]
                    }
                    timeSeriesConfirmed_Australia_Total.push(column)
                }

                timeSeriesConfirmed_China_Total=[]
                for (i=0;i<timeSeriesConfirmed_China[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesConfirmed_China.length;n++) {
                        column+=timeSeriesConfirmed_China[n][i]
                    }
                    timeSeriesConfirmed_China_Total.push(column)
                }
                //zip values from both lists
                let cStatesOverSeas = confirmedLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, confirmedValues_StatesAndOverseas[i]];
                });
                //sort descending
                cStatesOverSeas.sort(function(a,b){return b[1]-a[1]})

                //zip values from both lists
                let cStatesOverSeas_OneDayAgo = confirmedLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, confirmedValues_StatesAndOverseas_OneDayAgo[i]];
                });
                //sort descending
                cStatesOverSeas_OneDayAgo.sort(function(a,b){return b[1]-a[1];});
                let c = confirmedLabels.map(function(e, i) {
                    return [e, confirmedValues[i]];
                });
                //sort descending
                c.sort(function(a,b){return b[1]-a[1];});
                //zip values from both lists
                let cYes = confirmedLabels.map(function(e, i) {
                    return [e, confirmedValues_OneDayAgo[i]];
                });
                //sort descending
                cYes.sort(function(a,b){return b[1]-a[1];});

                //create new lists to separate and store the sorted data
                sortedConfirmedLabels=[];
                sortedConfirmedValues=[];
                function separateValues() {
                    for (n = 0; n < c.length; n++) {
                        if (c [n][1]!=0) {
                            sortedConfirmedLabels.push(c[n][0])
                        }
                    }
                    for (n = 0; n < c.length; n++) {
                        if (c[n][1]!=0) {
                            sortedConfirmedValues.push(c[n][1])
                        }
                    }
                }
                separateValues()
                //all total confirmed regardless of country
                function totalGlobal_Confirmed() {
                    for (n = 0; n < c.length; n++) {
                        worldTotal_Confirmed+=c[n][1]
                    }
                    return worldTotal_Confirmed
                }
                totalGlobal_Confirmed()

                //number to string with comma separation
                function numberWithCommas(x) {
                    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                }
                let worldTotal_Confirmed_String= numberWithCommas(worldTotal_Confirmed)

                document.getElementById("totalConfirmed").innerHTML="<b>Total Confirmed Cases:</b> "+worldTotal_Confirmed_String

                let percentChangeDailyArray=[]
                let selectedConfirmedLabels=[]
                let newCasesArray=[]
                let newCasesLabelsArray=[]
                //calculate daily change compared to data from the day before
                function DailyChange(){
                    for (n = 0; n < confirmedValues.length; n++) {
                        let diff=confirmedValues[n]-confirmedValues_OneDayAgo[n]
                        let perc= Math.round((confirmedValues[n]-confirmedValues_OneDayAgo[n])*100/confirmedValues_OneDayAgo[n])
                        if (perc==Infinity) {
                            newCasesArray.push("First Case")
                            newCasesLabelsArray.push(confirmedLabels[n])
                        }
                        else if (diff>100){
                            percentChangeDailyArray.push(perc)
                            selectedConfirmedLabels.push(confirmedLabels[n])
                        }
                    }
                }

                DailyChange();
                let changeDailyArray=[]
                //calculate daily change compared to data from the day before
                function dailyChangeNumber(){
                    for (n = 0; n < confirmedValues.length; n++) {
                        let difference= confirmedValues[n]-confirmedValues_OneDayAgo[n]
                        changeDailyArray.push(difference)

                    }
                }
                dailyChangeNumber();

                //zip values from both lists difference change and labels NUMBER OF PERSONS
                let zippedChangeDaily = confirmedLabels.map(function(e, i) {
                    return [e, changeDailyArray[i]];
                });
                //sort descending percent change
                zippedChangeDaily.sort(function(a,b){return b[1]-a[1];});

                let topTenDifference=[]
                function selectTopTen() {
                    topTenDifference=zippedChangeDaily.slice(0,10)
                }
                selectTopTen()

                let topTenDiffString="";
                for (i=0;i<topTenDifference.length;i++){
                    topTenDiffString+=topTenDifference[i][0]+" - "+topTenDifference[i][1]
                    if (topTenDifference[i+1]){
                        topTenDiffString+="</br>"
                    } else {
                        topTenDiffString+=""
                    }
                }

                //push the values the document
                document.getElementById("caseIncrease").innerHTML="<b>Top 10 countries with the highest daily increase in number of persons infected:</b> "+"</br>"+topTenDiffString

                //zip values from both lists perc change and labels
                let zippedPercDailyChange = selectedConfirmedLabels.map(function(e, i) {
                    return [e, percentChangeDailyArray[i]];
                });
                //sort descending percent change
                zippedPercDailyChange.sort(function(a,b){return b[1]-a[1];});
                
                let zippedNewCasesAndLabels = newCasesLabelsArray.map(function(e, i) {
                    return [e, newCasesArray[i]];
                });

                let newCases=[]
                //finding countries with the first ever cases
                function SelectNewCases(){
                    for (p=0; p<zippedNewCasesAndLabels.length; p++) {
                        if ((zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="US") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Mainland China")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="China") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Canada") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case"  && zippedNewCasesAndLabels[p][0]!="Australia")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="France")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="United Kingdom" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Netherlands" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Denmark" )) {
                            newCases.push(zippedNewCasesAndLabels[p][0])
                        }

                    }

                }
                SelectNewCases()
                //if there is no new country
                if (newCases.length==0) {
                    newCases.push("N/A for today")
                }
                let newCasesString="";
                function newCasesToString(){
                    for (i=0; i<newCases.length;i++){
                        newCasesString+=newCases[i]
                        if (newCases[i+1]){
                            newCasesString+=" - "
                        }
                        else {
                            newCasesString+=""
                        }
                    }
                }
                newCasesToString()
                //slice countries with the top five % daily change from top
                let topFive=[]
                function selectTopFive() {
                    topFive=zippedPercDailyChange.slice(0,5)
                }
                selectTopFive()
                //find the today's cases for corresponding country from the topFive list
                let toConfirmed=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<c.length;n++){
                            if(topFive[i][0]==c[n][0]){
                                toConfirmed.push(c[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas.length;m++){
                            if(topFive[i][0]==cStatesOverSeas[m][0] ) {
                                toConfirmed.push(cStatesOverSeas[m][1])
                            }
                        }
                    }
                }


                //find the yesterday's deaths for corresponding country from the topFive list
                let fromConfirmed=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<cYes.length;n++){
                            if(topFive[i][0]==cYes[n][0]){
                                fromConfirmed.push(cYes[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas_OneDayAgo.length;m++){
                            if(topFive[i][0]==cStatesOverSeas_OneDayAgo[m][0] ) {
                                fromConfirmed.push(cStatesOverSeas_OneDayAgo[m][1])
                            }
                        }
                    }
                }

                //put them in a format that will be displayed properly to the user
                let topFiveString="";
                function createString(){
                    for (v=0;v<topFive.length;v++){
                        topFiveString+=topFive[v][0]
                        topFiveString+=" "
                        topFiveString+=topFive[v][1]
                        if (topFive[v+1]){
                            topFiveString+="% - from "+fromConfirmed[v]+" to "+ toConfirmed[v]+ "</br> "
                        } else {
                            topFiveString+="% - from "+fromConfirmed[v]+" to "+toConfirmed[v]
                        }
                    }
                }
                createString()
                //push the values the document
                document.getElementById("firstCases").innerHTML="<b>Countries that most recently announced the first confirmed cases within their borders:</b> "+"</br>"+newCasesString
                document.getElementById("topFive").innerHTML="<b>Countries with the highest daily % change in confirmed cases (over 100 cases): </b> "+"</br>"+topFiveString

                //////// Speed in reaching cases
                function findFastest(x){
                    dateOfFirstCase=0;
                    dateOf_x_Case=0;
                    passedNumberOfDaysFinal=1000;
                    fastestCountry="";
                    passedNumberOfDays=0
                    for (i=1; i< results.data.length; i++) {
                        for (n=4;n<43;n++){
                            if (results.data[i][4]>0 && results.data[i][1]!="China" ){
                                dateOfFirstCase=4
                                if (results.data[i][n-1]<x && results.data[i][n]>=x){
                                    dateOf_x_Case=n
                                    passedNumberOfDays= dateOf_x_Case-dateOfFirstCase
                                    if (passedNumberOfDays<passedNumberOfDaysFinal){
                                        passedNumberOfDaysFinal=passedNumberOfDays
                                        fastestCountry=x+ " confirmed cases: "+results.data[i][1]+" / "+ passedNumberOfDays+" days"
                                    }
                                }
                            }
                            else if (results.data[i][1]!="China" && results.data[i][4]==0) {
                                if(results.data[i][n-1]==0 && results.data[i][n]>0){
                                    dateOfFirstCase=n
                                }               if (results.data[i][n-1]<x && results.data[i][n]>=x){
                                    dateOf_x_Case=n
                                    passedNumberOfDays= dateOf_x_Case-dateOfFirstCase
                                    if (passedNumberOfDays<passedNumberOfDaysFinal){
                                        passedNumberOfDaysFinal=passedNumberOfDays
                                        fastestCountry=x+ " confirmed cases: "+results.data[i][1]+" / "+ passedNumberOfDays+" days"
                                    }
                                }
                            }
                        }

                    }
                }

                fastestConfirmed1000="";
                findFastest(1000)
                fastestConfirmed1000=fastestCountry

                fastestConfirmed5000="";
                findFastest(5000)
                fastestConfirmed5000=fastestCountry

                fastestConfirmed10000="";
                findFastest(10000)
                fastestConfirmed10000=fastestCountry
                fastestConfirmed20000="";
                findFastest(20000)
                fastestConfirmed20000=fastestCountry
                fastestConfirmed30000="";
                findFastest(30000)
                fastestConfirmed30000=fastestCountry
                fastestConfirmed50000="";
                findFastest(50000)
                fastestConfirmed50000=fastestCountry
                fastestConfirmed70000="";
                findFastest(70000)
                fastestConfirmed70000=fastestCountry
                fastestConfirmed100000="";
                findFastest(100000)
                fastestConfirmed100000=fastestCountry
                //push the values the document
                document.getElementById("fastestConfirmed").innerHTML="<b>Country (except China) fastest reaching to:</b> "+"</br>"+fastestConfirmed1000+"</br>"+fastestConfirmed5000+"</br>"+fastestConfirmed10000+"</br>"+fastestConfirmed20000+"</br>"+fastestConfirmed30000+"</br>"+fastestConfirmed50000+"</br>"+fastestConfirmed70000+"</br>"+fastestConfirmed100000


                ////Graphs for confirmed cases
                Highcharts.chart('containerBarConfirmed', {
                    chart: {
                        type: 'bar'
                    },
                    
   
                    
                    title: {
                        text: 'Confirmed COVID-19 CASES'
                    },
                    subtitle: {
                        text: 'Total Confirmed by Country'
                    },
                    xAxis: {
                        categories: sortedConfirmedLabels,
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Number of Persons',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valueSuffix: ' '
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    /*legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -40,
                        y: 80,
                        floating: true,
                        borderWidth: 1,
                        backgroundColor:
                            Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
                        shadow: true
                    },*/
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Confirmed Cases',
                        data:sortedConfirmedValues,
                        color: '#feb24c'
                    }]
                });

                //Line chart
                Highcharts.chart('containerLineConfirmed', {
                    title: {
                        text: 'Growth of Confirmed Cases by Country'
                    },
                    subtitle: {
                        text: 'Starting Date:1/22/20'
                    },
                    credits: {
                        enabled: false
                    },
        
                    yAxis: {
                        title: {
                            text: 'Persons'
                        }
                    },
                    xAxis: {
                        categories: timeSeriesConfirmedLabels[0]
                    },
                    legend: {
                        itemStyle: {
                            fontSize:"9px"
                        },
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle'
                    },
                    tooltip: {
                        style:{


                            fontSize:"9px",
                        },
                        split: true,
                        distance: 5,
                        padding: 1
                    },
                    plotOptions: {
                        series: {
                            label: {
                                connectorAllowed: false
                            },
                            pointStart: 0
                        }
                    },
                    series: [{
                        name: 'UK',
                        data: timeSeriesConfirmed_UK[0]
                    }, {
                        name: 'France',
                        data: timeSeriesConfirmed_France[0]
                    },{
                        name: 'Turkey',
                        data: timeSeriesConfirmed_Turkey[0]
                    },{
                        name: 'Germany',
                        data: timeSeriesConfirmed_Germany[0]
                    },{
                        name: 'South Korea',
                        data: timeSeriesConfirmed_SouthKorea[0]
                    },{
                        name: 'Spain',
                        data: timeSeriesConfirmed_Spain[0]
                    },{
                        name: 'Italy',
                        data: timeSeriesConfirmed_Italy[0]
                    },{
                        name: 'Iran',
                        data: timeSeriesConfirmed_Iran[0]
                    },{
                        name: 'Switzerland',
                        data: timeSeriesConfirmed_Switzerland[0]
                    }
                        ,{
                            name: 'US',
                            data: timeSeriesConfirmed_US_Total
                        }
                        ,{
                            name: 'Canada',
                            data: timeSeriesConfirmed_Canada_Total
                        },{
                            name: 'Australia',
                            data: timeSeriesConfirmed_Australia_Total
                        },{
                            name: 'China',
                            data: timeSeriesConfirmed_China_Total
                        },{
                            name: 'Czechia',
                            data: timeSeriesConfirmed_Czechia[0]
                        },{
                            name: 'Netherlands',
                            data: timeSeriesConfirmed_NL[0]
                        }],
                        

                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 500
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]
                    },

                    /*annotations: [{
        labelOptions: {
           backgroundColor: 'rgba(255,255,255,0.5)',
            verticalAlign: 'top',
            y: 15
        },
        labels: [{
            point: {
                xAxis: 0,
                yAxis: 0,
                x: '5',
                y: 25000
            },
            text: 'Arbois'
        }] }],*/
                });

            },

        });

        /////////////////////////////////////////////////////////////////////////////////////////
        //GRAPH, DATA OPERATIONS for Deaths

        let timeSeriesDeathsLabels=[]
        let worldTotal_Deaths=0;
        let deathsLabels=[];
        let deathsValues=[];
        //states and overseas variable is mainly required to avoid calculation mistakes for countries like UK,NL,FR
        let deathsLabels_StatesAndOverseas=[];
        let deathsValues_StatesAndOverseas=[];
        let deathsValues_StatesAndOverseas_OneDayAgo=[];
        let deathsValues_OneDayAgo=[];
        //time series to be used in line graph visualisation
        let timeSeriesDeaths_US=[]
        let timeSeriesDeaths_Australia=[]
        let timeSeriesDeaths_Canada=[]
        let timeSeriesDeaths_China=[]
        let timeSeriesDeaths_Iran=[]
        let timeSeriesDeaths_Italy=[]
        let timeSeriesDeaths_Spain=[]
        let timeSeriesDeaths_Turkey=[]
        let timeSeriesDeaths_UK=[]
        let timeSeriesDeaths_Germany=[]
        let timeSeriesDeaths_France=[]
        let timeSeriesDeaths_Switzerland=[]
        let timeSeriesDeaths_SouthKorea=[]
        let timeSeriesDeaths_Japan=[]
        let timeSeriesDeaths_Czechia=[]
        let timeSeriesDeaths_NL=[]
        //In order to find total cases in US,China,Canada and Australia, whose data is presented separately for states
        let totalDeaths_US=0;
        let totalDeaths_China=0;
        let totalDeaths_Canada=0;
        let totalDeaths_Aus=0;
        //in order to find daily change %
        let totalDeaths_US_OneDayAgo=0;
        let totalDeaths_China_OneDayAgo=0;
        let totalDeaths_Canada_OneDayAgo=0;
        let totalDeaths_Aus_OneDayAgo=0;
        //putting deaths cases into array format, into the empty arrays defined above
        Papa.parse("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv", {
            download: true,
            dynamicTyping: true,
            complete: function(results) {
                //select the latest column
                let lastCol=43;
                //getting the header of the last column to use as date info in the app
                let lastColHeader=results.data[0][lastCol]

                document.getElementById("dataDate").innerHTML="<b>Data Date:</b> "+lastColHeader
                //select the column before the latest to use its data in daily % change calc
                let last2Col=42;
                timeSeriesDeathsLabels.push((results.data[0]).slice(4,lastCol+1))
                console.log(timeSeriesDeathsLabels)
                //find the row where country name is either "US","China","Canada" or "Australia"
                //and add the corresponding value to the total sum of that country
                for (i=1; i< results.data.length-1; i++) {
                    if (results.data[i][1]=="US"){
                        deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        
                        timeSeriesDeaths_US.push((results.data[i].slice(4,lastCol+1)))
                        console.log(timeSeriesDeaths_US)
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalDeaths_US=totalDeaths_US + nmbr
                        totalDeaths_US_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="China"){
                        deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesDeaths_China.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalDeaths_China=totalDeaths_China + nmbr
                        totalDeaths_China_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Canada"){
                        deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesDeaths_Canada.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalDeaths_Canada=totalDeaths_Canada + nmbr
                        totalDeaths_Canada_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Australia"){
                        deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesDeaths_Australia.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalDeaths_Aus=totalDeaths_Aus + nmbr
                        totalDeaths_Aus_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]==="France"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            deathsLabels_StatesAndOverseas.push(results.data[i][1])
                            deathsLabels.push(results.data[i][1])
                            timeSeriesDeaths_France.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            deathsLabels.push(results.data[i][0])
                            deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        deathsValues.push(nmbr);
                        deathsValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Netherlands"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            deathsLabels_StatesAndOverseas.push(results.data[i][1])
                            deathsLabels.push(results.data[i][1])
                            timeSeriesDeaths_NL.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            deathsLabels.push(results.data[i][0])
                            deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        deathsValues.push(nmbr);
                        deathsValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="United Kingdom"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            deathsLabels_StatesAndOverseas.push(results.data[i][1])
                            deathsLabels.push(results.data[i][1])
                            timeSeriesDeaths_UK.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            deathsLabels.push(results.data[i][0])
                            deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        deathsValues.push(nmbr);
                        deathsValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Denmark"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            deathsLabels_StatesAndOverseas.push(results.data[i][1])
                            deathsLabels.push(results.data[i][1])
                        } else {
                            deathsLabels.push(results.data[i][0])
                            deathsLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        deathsValues.push(nmbr);
                        deathsValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                        //except US,China,Canada and Australia. Push the country name to the labels list
                    //and push the corresponding value to the values list
                    else if (results.data[i][1]!="US" || results.data[i][1]!="Mainland China"|| results.data[i][1]!="China"
                        || results.data[i][1]!="Canada" || results.data[i][1]!="Australia" || results.data[i][1]!="Denmark" || results.data[i][1]!="France" || results.data[i][1]!="United Kingdom" ||
                        results.data[i][1]!="Netherlands" ){
                        deathsLabels_StatesAndOverseas.push(results.data[i][1])
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        let nmbr=results.data[i][lastCol];
                        deathsValues_StatesAndOverseas.push(nmbr)
                        deathsValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        deathsValues.push(nmbr);
                        deathsLabels.push(results.data[i][1])
                        deathsValues_OneDayAgo.push(nmbr_OneDayAgo)
                        if (results.data[i][1]=="Turkey") {
                            timeSeriesDeaths_Turkey.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Germany") {
                            timeSeriesDeaths_Germany.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Korea, South") {
                            timeSeriesDeaths_SouthKorea.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Spain") {
                            timeSeriesDeaths_Spain.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Italy") {
                            timeSeriesDeaths_Italy.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Iran") {
                            timeSeriesDeaths_Iran.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Switzerland") {
                            timeSeriesDeaths_Switzerland.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Czechia") {
                            timeSeriesDeaths_Czechia.push(results.data[i].slice(4,lastCol+1))
                        }

                    }
                    else {
                        console.log("ERROR")
                    }
                }
                deathsLabels.push("US","China","Canada","Australia");
                deathsValues.push(totalDeaths_US,totalDeaths_China, totalDeaths_Canada, totalDeaths_Aus);
                deathsValues_OneDayAgo.push(totalDeaths_US_OneDayAgo,totalDeaths_China_OneDayAgo,totalDeaths_Canada_OneDayAgo,totalDeaths_Aus_OneDayAgo)
                timeSeriesDeaths_US_Total=[]
              
                for (i=0;i<timeSeriesDeaths_US[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesDeaths_US.length;n++) {
                        column+=timeSeriesDeaths_US[n][i]
                    }
                    timeSeriesDeaths_US_Total.push(column)
                }
                console.log(timeSeriesDeaths_Czechia)
                console.log(timeSeriesDeaths_US_Total)
            
                timeSeriesDeaths_Canada_Total=[]
                for (i=0;i<timeSeriesDeaths_Canada[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesDeaths_Canada.length;n++) {
                        column+=timeSeriesDeaths_Canada[n][i]
                    }
                    timeSeriesDeaths_Canada_Total.push(column)
                }
                timeSeriesDeaths_Australia_Total=[]
                for (i=0;i<timeSeriesDeaths_Australia[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesDeaths_Australia.length;n++) {
                        column+=timeSeriesDeaths_Australia[n][i]
                    }
                    timeSeriesDeaths_Australia_Total.push(column)
                }

                timeSeriesDeaths_China_Total=[]
                for (i=0;i<timeSeriesDeaths_China[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesDeaths_China.length;n++) {
                        column+=timeSeriesDeaths_China[n][i]
                    }
                    timeSeriesDeaths_China_Total.push(column)
                }
                //zip values from both lists
                let cStatesOverSeas = deathsLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, deathsValues_StatesAndOverseas[i]];
                });
                //sort descending
                cStatesOverSeas.sort(function(a,b){return b[1]-a[1]})

                //zip values from both lists
                let cStatesOverSeas_OneDayAgo = deathsLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, deathsValues_StatesAndOverseas_OneDayAgo[i]];
                });
                //sort descending
                cStatesOverSeas_OneDayAgo.sort(function(a,b){return b[1]-a[1];});
                let c = deathsLabels.map(function(e, i) {
                    return [e, deathsValues[i]];
                });
                //sort descending
                c.sort(function(a,b){return b[1]-a[1];});
                //zip values from both lists
                let cYes = deathsLabels.map(function(e, i) {
                    return [e, deathsValues_OneDayAgo[i]];
                });
                //sort descending
                cYes.sort(function(a,b){return b[1]-a[1];});

                //create new lists to separate and store the sorted data
                sortedDeathsLabels=[];
                sortedDeathsValues=[];
                function separateValues() {
                    for (n = 0; n < c.length; n++) {
                        if (c [n][1]!=0) {
                            sortedDeathsLabels.push(c[n][0])
                        }
                    }
                    for (n = 0; n < c.length; n++) {
                        if (c[n][1]!=0) {
                            sortedDeathsValues.push(c[n][1])
                        }
                    }
                }
                separateValues()
                //all total deaths regardless of country
                function totalGlobal_Deaths() {
                    for (n = 0; n < c.length; n++) {
                        worldTotal_Deaths+=c[n][1]
                    }
                    return worldTotal_Deaths
                }
                totalGlobal_Deaths()

                //number to string with comma separation
                function numberWithCommas(x) {
                    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                }
                let worldTotal_Deaths_String= numberWithCommas(worldTotal_Deaths)

                document.getElementById("totalDeaths").innerHTML="<b>Total Deaths:</b> "+worldTotal_Deaths_String



                let percentChangeDailyArray=[]
                let selectedDeathsLabels=[]
                let newCasesArray=[]
                let newCasesLabelsArray=[]
                //calculate daily change compared to data from the day before
                function DailyChange(){
                    for (n = 0; n < deathsValues.length; n++) {
                        let diff=deathsValues[n]-deathsValues_OneDayAgo[n]
                        let perc= Math.round((deathsValues[n]-deathsValues_OneDayAgo[n])*100/deathsValues_OneDayAgo[n])
                        if (perc==Infinity) {
                            newCasesArray.push("First Case")
                            newCasesLabelsArray.push(deathsLabels[n])
                        }
                        else if (diff>0){
                            percentChangeDailyArray.push(perc)
                            selectedDeathsLabels.push(deathsLabels[n])
                        }
                    }
                }

                DailyChange();
                let changeDailyArray=[]
                //calculate daily change compared to data from the day before
                function dailyChangeNumber(){
                    for (n = 0; n < deathsValues.length; n++) {
                        let difference= deathsValues[n]-deathsValues_OneDayAgo[n]
                        changeDailyArray.push(difference)

                    }
                }
                dailyChangeNumber();

                //zip values from both lists difference change and labels NUMBER OF PERSONS
                let zippedChangeDaily = deathsLabels.map(function(e, i) {
                    return [e, changeDailyArray[i]];
                });
                //sort descending percent change
                zippedChangeDaily.sort(function(a,b){return b[1]-a[1];});

                let topTenDifference=[]
                function selectTopTen() {
                    topTenDifference=zippedChangeDaily.slice(0,10)
                }
                selectTopTen()

                let topTenDiffString="";
                for (i=0;i<topTenDifference.length;i++){
                    topTenDiffString+=topTenDifference[i][0]+" - "+topTenDifference[i][1]
                    if (topTenDifference[i+1]){
                        topTenDiffString+="</br>"
                    } else {
                        topTenDiffString+=""
                    }
                }

                //push the values the document
                document.getElementById("deathIncrease").innerHTML="<b>Top 10 countries with the highest daily increase in number of persons infected:</b> "+"</br>"+topTenDiffString



                //zip values from both lists perc change and labels
                let zippedPercDailyChange = selectedDeathsLabels.map(function(e, i) {
                    return [e, percentChangeDailyArray[i]];
                });
                //sort descending percent change
                zippedPercDailyChange.sort(function(a,b){return b[1]-a[1];});
                
                let zippedNewCasesAndLabels = newCasesLabelsArray.map(function(e, i) {
                    return [e, newCasesArray[i]];
                });

                let newCases=[]
                //finding countries with the first ever cases
                function SelectNewCases(){
                    for (p=0; p<zippedNewCasesAndLabels.length; p++) {
                        if ((zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="US") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Mainland China")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="China") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Canada") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case"  && zippedNewCasesAndLabels[p][0]!="Australia")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="France")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="United Kingdom" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Netherlands" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Denmark" )) {
                            newCases.push(zippedNewCasesAndLabels[p][0])
                        }

                    }

                }
                SelectNewCases()
                //if there is no new country
                if (newCases.length==0) {
                    newCases.push("N/A for today")
                }
                let newCasesString="";
                function newCasesToString(){
                    for (i=0; i<newCases.length;i++){
                        newCasesString+=newCases[i]
                        if (newCases[i+1]){
                            newCasesString+=" - "
                        }
                        else {
                            newCasesString+=""
                        }
                    }
                }
                newCasesToString()
                //slice countries with the top five % daily change from top
                let topFive=[]
                function selectTopFive() {
                    topFive=zippedPercDailyChange.slice(0,5)
                }
                selectTopFive()
                //find the today's cases for corresponding country from the topFive list
                let toDeaths=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<c.length;n++){
                            if(topFive[i][0]==c[n][0]){
                                toDeaths.push(c[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas.length;m++){
                            if(topFive[i][0]==cStatesOverSeas[m][0] ) {
                                toDeaths.push(cStatesOverSeas[m][1])
                            }
                        }
                    }
                }


                //find the yesterday's deaths for corresponding country from the topFive list
                let fromDeaths=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<cYes.length;n++){
                            if(topFive[i][0]==cYes[n][0]){
                                fromDeaths.push(cYes[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas_OneDayAgo.length;m++){
                            if(topFive[i][0]==cStatesOverSeas_OneDayAgo[m][0] ) {
                                fromDeaths.push(cStatesOverSeas_OneDayAgo[m][1])
                            }
                        }
                    }
                }

                //put them in a format that will be displayed properly to the user
                let topFiveString="";
                function createString(){
                    for (v=0;v<topFive.length;v++){
                        topFiveString+=topFive[v][0]
                        topFiveString+=" "
                        topFiveString+=topFive[v][1]
                        if (topFive[v+1]){
                            topFiveString+="% - from "+fromDeaths[v]+" to "+ toDeaths[v]+ "</br> "
                        } else {
                            topFiveString+="% - from "+fromDeaths[v]+" to "+toDeaths[v]
                        }
                    }
                }
                createString()
                //push the values the document
                document.getElementById("firstDeath").innerHTML="<b>Countries that most recently announced the first deaths within their borders:</b> "+"</br>"+newCasesString
                document.getElementById("topFiveDeath").innerHTML="<b>Countries with the highest daily % change in deaths: </b> "+"</br>"+topFiveString


        


                ////Graphs for deaths cases
                Highcharts.chart('containerBarDeaths', {
                    chart: {
                        type: 'bar'
                    },
                    
   
                    
                    title: {
                        text: 'Deaths'
                    },
                    subtitle: {
                        text: 'Total Deaths by Country'
                    },
                    xAxis: {
                        categories: sortedDeathsLabels,
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Number of Persons',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valueSuffix: ' '
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    /*legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -40,
                        y: 80,
                        floating: true,
                        borderWidth: 1,
                        backgroundColor:
                            Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
                        shadow: true
                    },*/
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Deaths',
                        data:sortedDeathsValues,
                        color: '#de2d26'
                    }]
                });

                

                //Line chart
                Highcharts.chart('containerLineDeaths', {
                    title: {
                        text: 'Growth of Deaths by Country'
                    },
                    subtitle: {
                        text: 'Starting Date:1/22/20'
                    },
                    credits: {
                        enabled: false
                    },
        
                    yAxis: {
                        title: {
                            text: 'Persons'
                        }
                    },
                    xAxis: {
                        categories: timeSeriesDeathsLabels[0]
                    },
                    legend: {
                        itemStyle: {
                            fontSize:"9px"
                        },
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle'
                    },
                    tooltip: {
                        style:{


                            fontSize:"9px",
                        },
                        split: true,
                        distance: 5,
                        padding: 1
                    },
                    plotOptions: {
                        series: {
                            label: {
                                connectorAllowed: false
                            },
                            pointStart: 0
                        }
                    },
                    series: [{
                        name: 'UK',
                        data: timeSeriesDeaths_UK[0]
                    }, {
                        name: 'France',
                        data: timeSeriesDeaths_France[0]
                    },{
                        name: 'Turkey',
                        data: timeSeriesDeaths_Turkey[0]
                    },{
                        name: 'Germany',
                        data: timeSeriesDeaths_Germany[0]
                    },{
                        name: 'South Korea',
                        data: timeSeriesDeaths_SouthKorea[0]
                    },{
                        name: 'Spain',
                        data: timeSeriesDeaths_Spain[0]
                    },{
                        name: 'Italy',
                        data: timeSeriesDeaths_Italy[0]
                    },{
                        name: 'Iran',
                        data: timeSeriesDeaths_Iran[0]
                    },{
                        name: 'Switzerland',
                        data: timeSeriesDeaths_Switzerland[0]
                    }
                        ,{
                            name: 'US',
                            data: timeSeriesDeaths_US_Total
                        }
                        ,{
                            name: 'Canada',
                            data: timeSeriesDeaths_Canada_Total
                        },{
                            name: 'Australia',
                            data: timeSeriesDeaths_Australia_Total
                        },{
                            name: 'China',
                            data: timeSeriesDeaths_China_Total
                        },{
                            name: 'Czechia',
                            data: timeSeriesDeaths_Czechia[0]
                        },{
                            name: 'Netherlands',
                            data: timeSeriesDeaths_NL[0]
                        }],
                        

                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 500
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]
                    },

                    /*annotations: [{
        labelOptions: {
           backgroundColor: 'rgba(255,255,255,0.5)',
            verticalAlign: 'top',
            y: 15
        },
        labels: [{
            point: {
                xAxis: 0,
                yAxis: 0,
                x: '5',
                y: 25000
            },
            text: 'Arbois'
        }] }],*/
                });

            },

        });

 


        //GRAPH, DATA OPERATIONS for RECOVERED////////////////////////////
        //////////////////////////////////////////////////////////////////


        let timeSeriesRecoveredLabels=[]
        let worldTotal_Recovered=0;
        let recoveredLabels=[];
        let recoveredValues=[];
        //states and overseas variable is mainly required to avoid calculation mistakes for countries like UK,NL,FR
        let recoveredLabels_StatesAndOverseas=[];
        let recoveredValues_StatesAndOverseas=[];
        let recoveredValues_StatesAndOverseas_OneDayAgo=[];
        let recoveredValues_OneDayAgo=[];
        //time series to be used in line graph visualisation
        let timeSeriesRecovered_US=[]
        let timeSeriesRecovered_Australia=[]
        let timeSeriesRecovered_Canada=[]
        let timeSeriesRecovered_China=[]
        let timeSeriesRecovered_Iran=[]
        let timeSeriesRecovered_Italy=[]
        let timeSeriesRecovered_Spain=[]
        let timeSeriesRecovered_Turkey=[]
        let timeSeriesRecovered_UK=[]
        let timeSeriesRecovered_Germany=[]
        let timeSeriesRecovered_France=[]
        let timeSeriesRecovered_Switzerland=[]
        let timeSeriesRecovered_SouthKorea=[]
        let timeSeriesRecovered_Japan=[]
        let timeSeriesRecovered_Czechia=[]
        let timeSeriesRecovered_NL=[]
        //In order to find total cases in US,China,Canada and Australia, whose data is presented separately for states
        let totalRecovered_US=0;
        let totalRecovered_China=0;
        let totalRecovered_Canada=0;
        let totalRecovered_Aus=0;
        //in order to find daily change %
        let totalRecovered_US_OneDayAgo=0;
        let totalRecovered_China_OneDayAgo=0;
        let totalRecovered_Canada_OneDayAgo=0;
        let totalRecovered_Aus_OneDayAgo=0;
        //putting recovered cases into array format, into the empty arrays defined above
        Papa.parse("https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_recovered_global.csv", {
            download: true,
            dynamicTyping: true,
            complete: function(results) {
                //select the latest column
                let lastCol=43;
                //getting the header of the last column to use as date info in the app
                let lastColHeader=results.data[0][lastCol]

                document.getElementById("dataDate").innerHTML="<b>Data Date:</b> "+lastColHeader
                //select the column before the latest to use its data in daily % change calc
                let last2Col=42;
                timeSeriesRecoveredLabels.push((results.data[0]).slice(4,lastCol+1))
                console.log(timeSeriesRecoveredLabels)
                //find the row where country name is either "US","China","Canada" or "Australia"
                //and add the corresponding value to the total sum of that country
                for (i=1; i< results.data.length-1; i++) {
                    if (results.data[i][1]=="US"){
                        recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        
                        timeSeriesRecovered_US.push((results.data[i].slice(4,lastCol+1)))
                        console.log(timeSeriesRecovered_US)
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalRecovered_US=totalRecovered_US + nmbr
                        totalRecovered_US_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="China"){
                        recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesRecovered_China.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalRecovered_China=totalRecovered_China + nmbr
                        totalRecovered_China_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Canada"){
                        recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesRecovered_Canada.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalRecovered_Canada=totalRecovered_Canada + nmbr
                        totalRecovered_Canada_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]=="Australia"){
                        recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        timeSeriesRecovered_Australia.push((results.data[i].slice(4,lastCol+1)))
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        totalRecovered_Aus=totalRecovered_Aus + nmbr
                        totalRecovered_Aus_OneDayAgo+=nmbr_OneDayAgo
                    }
                    else if (results.data[i][1]==="France"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            recoveredLabels_StatesAndOverseas.push(results.data[i][1])
                            recoveredLabels.push(results.data[i][1])
                            timeSeriesRecovered_France.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            recoveredLabels.push(results.data[i][0])
                            recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        recoveredValues.push(nmbr);
                        recoveredValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Netherlands"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            recoveredLabels_StatesAndOverseas.push(results.data[i][1])
                            recoveredLabels.push(results.data[i][1])
                            timeSeriesRecovered_NL.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            recoveredLabels.push(results.data[i][0])
                            recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        recoveredValues.push(nmbr);
                        recoveredValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="United Kingdom"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            recoveredLabels_StatesAndOverseas.push(results.data[i][1])
                            recoveredLabels.push(results.data[i][1])
                            timeSeriesRecovered_UK.push(results.data[i].slice(4,lastCol+1))
                        } else {
                            recoveredLabels.push(results.data[i][0])
                            recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        recoveredValues.push(nmbr);
                        recoveredValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                    else if (results.data[i][1]==="Denmark"){
                        let nmbr=results.data[i][lastCol];
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        if (results.data[i][0]===null) {
                            recoveredLabels_StatesAndOverseas.push(results.data[i][1])
                            recoveredLabels.push(results.data[i][1])
                        } else {
                            recoveredLabels.push(results.data[i][0])
                            recoveredLabels_StatesAndOverseas.push(results.data[i][0])
                        }
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        recoveredValues.push(nmbr);
                        recoveredValues_OneDayAgo.push(nmbr_OneDayAgo)
                    }
                        //except US,China,Canada and Australia. Push the country name to the labels list
                    //and push the corresponding value to the values list
                    else if (results.data[i][1]!="US" || results.data[i][1]!="Mainland China"|| results.data[i][1]!="China"
                        || results.data[i][1]!="Canada" || results.data[i][1]!="Australia" || results.data[i][1]!="Denmark" || results.data[i][1]!="France" || results.data[i][1]!="United Kingdom" ||
                        results.data[i][1]!="Netherlands" ){
                        recoveredLabels_StatesAndOverseas.push(results.data[i][1])
                        let nmbr_OneDayAgo=results.data[i][last2Col];
                        let nmbr=results.data[i][lastCol];
                        recoveredValues_StatesAndOverseas.push(nmbr)
                        recoveredValues_StatesAndOverseas_OneDayAgo.push(nmbr_OneDayAgo)
                        recoveredValues.push(nmbr);
                        recoveredLabels.push(results.data[i][1])
                        recoveredValues_OneDayAgo.push(nmbr_OneDayAgo)
                        if (results.data[i][1]=="Turkey") {
                            timeSeriesRecovered_Turkey.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Germany") {
                            timeSeriesRecovered_Germany.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Korea, South") {
                            timeSeriesRecovered_SouthKorea.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Spain") {
                            timeSeriesRecovered_Spain.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Italy") {
                            timeSeriesRecovered_Italy.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Iran") {
                            timeSeriesRecovered_Iran.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Switzerland") {
                            timeSeriesRecovered_Switzerland.push(results.data[i].slice(4,lastCol+1))
                        }
                        else if (results.data[i][1]=="Czechia") {
                            timeSeriesRecovered_Czechia.push(results.data[i].slice(4,lastCol+1))
                        }

                    }
                    else {
                        console.log("ERROR")
                    }
                }
                recoveredLabels.push("US","China","Canada","Australia");
                recoveredValues.push(totalRecovered_US,totalRecovered_China, totalRecovered_Canada, totalRecovered_Aus);
                recoveredValues_OneDayAgo.push(totalRecovered_US_OneDayAgo,totalRecovered_China_OneDayAgo,totalRecovered_Canada_OneDayAgo,totalRecovered_Aus_OneDayAgo)
                timeSeriesRecovered_US_Total=[]
              
                for (i=0;i<timeSeriesRecovered_US[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesRecovered_US.length;n++) {
                        column+=timeSeriesRecovered_US[n][i]
                    }
                    timeSeriesRecovered_US_Total.push(column)
                }
                console.log(timeSeriesRecovered_Czechia)
                console.log(timeSeriesRecovered_US_Total)
            
                timeSeriesRecovered_Canada_Total=[]
                for (i=0;i<timeSeriesRecovered_Canada[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesRecovered_Canada.length;n++) {
                        column+=timeSeriesRecovered_Canada[n][i]
                    }
                    timeSeriesRecovered_Canada_Total.push(column)
                }
                timeSeriesRecovered_Australia_Total=[]
                for (i=0;i<timeSeriesRecovered_Australia[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesRecovered_Australia.length;n++) {
                        column+=timeSeriesRecovered_Australia[n][i]
                    }
                    timeSeriesRecovered_Australia_Total.push(column)
                }

                timeSeriesRecovered_China_Total=[]
                for (i=0;i<timeSeriesRecovered_China[0].length;i++){
                    column=0
                    for(n=0;n<timeSeriesRecovered_China.length;n++) {
                        column+=timeSeriesRecovered_China[n][i]
                    }
                    timeSeriesRecovered_China_Total.push(column)
                }
                //zip values from both lists
                let cStatesOverSeas = recoveredLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, recoveredValues_StatesAndOverseas[i]];
                });
                //sort descending
                cStatesOverSeas.sort(function(a,b){return b[1]-a[1]})

                //zip values from both lists
                let cStatesOverSeas_OneDayAgo = recoveredLabels_StatesAndOverseas.map(function(e, i) {
                    return [e, recoveredValues_StatesAndOverseas_OneDayAgo[i]];
                });
                //sort descending
                cStatesOverSeas_OneDayAgo.sort(function(a,b){return b[1]-a[1];});
                let c = recoveredLabels.map(function(e, i) {
                    return [e, recoveredValues[i]];
                });
                //sort descending
                c.sort(function(a,b){return b[1]-a[1];});
                //zip values from both lists
                let cYes = recoveredLabels.map(function(e, i) {
                    return [e, recoveredValues_OneDayAgo[i]];
                });
                //sort descending
                cYes.sort(function(a,b){return b[1]-a[1];});

                //create new lists to separate and store the sorted data
                sortedRecoveredLabels=[];
                sortedRecoveredValues=[];
                function separateValues() {
                    for (n = 0; n < c.length; n++) {
                        if (c [n][1]!=0) {
                            sortedRecoveredLabels.push(c[n][0])
                        }
                    }
                    for (n = 0; n < c.length; n++) {
                        if (c[n][1]!=0) {
                            sortedRecoveredValues.push(c[n][1])
                        }
                    }
                }
                separateValues()
                //all total recovered regardless of country
                function totalGlobal_Recovered() {
                    for (n = 0; n < c.length; n++) {
                        worldTotal_Recovered+=c[n][1]
                    }
                    return worldTotal_Recovered
                }
                totalGlobal_Recovered()

                //number to string with comma separation
                function numberWithCommas(x) {
                    return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                }
                let worldTotal_Recovered_String= numberWithCommas(worldTotal_Recovered)

                document.getElementById("totalRecovered").innerHTML="<b>Total Recovered:</b> "+worldTotal_Recovered_String



                let percentChangeDailyArray=[]
                let selectedRecoveredLabels=[]
                let newCasesArray=[]
                let newCasesLabelsArray=[]
                //calculate daily change compared to data from the day before
                function DailyChange(){
                    for (n = 0; n < recoveredValues.length; n++) {
                        let diff=recoveredValues[n]-recoveredValues_OneDayAgo[n]
                        let perc= Math.round((recoveredValues[n]-recoveredValues_OneDayAgo[n])*100/recoveredValues_OneDayAgo[n])
                        if (perc==Infinity) {
                            newCasesArray.push("First Case")
                            newCasesLabelsArray.push(recoveredLabels[n])
                        }
                        else if (diff>0){
                            percentChangeDailyArray.push(perc)
                            selectedRecoveredLabels.push(recoveredLabels[n])
                        }
                    }
                }

                DailyChange();
                let changeDailyArray=[]
                //calculate daily change compared to data from the day before
                function dailyChangeNumber(){
                    for (n = 0; n < recoveredValues.length; n++) {
                        let difference= recoveredValues[n]-recoveredValues_OneDayAgo[n]
                        changeDailyArray.push(difference)

                    }
                }
                dailyChangeNumber();

                //zip values from both lists difference change and labels NUMBER OF PERSONS
                let zippedChangeDaily = recoveredLabels.map(function(e, i) {
                    return [e, changeDailyArray[i]];
                });
                //sort descending percent change
                zippedChangeDaily.sort(function(a,b){return b[1]-a[1];});

                let topTenDifference=[]
                function selectTopTen() {
                    topTenDifference=zippedChangeDaily.slice(0,10)
                }
                selectTopTen()

                let topTenDiffString="";
                for (i=0;i<topTenDifference.length;i++){
                    topTenDiffString+=topTenDifference[i][0]+" - "+topTenDifference[i][1]
                    if (topTenDifference[i+1]){
                        topTenDiffString+="</br>"
                    } else {
                        topTenDiffString+=""
                    }
                }

                //push the values the document
                document.getElementById("recoveredIncrease").innerHTML="<b>Top 10 countries with the highest daily increase in number of persons infected:</b> "+"</br>"+topTenDiffString


       


                //zip values from both lists perc change and labels
                let zippedPercDailyChange = selectedRecoveredLabels.map(function(e, i) {
                    return [e, percentChangeDailyArray[i]];
                });
                //sort descending percent change
                zippedPercDailyChange.sort(function(a,b){return b[1]-a[1];});
                
                let zippedNewCasesAndLabels = newCasesLabelsArray.map(function(e, i) {
                    return [e, newCasesArray[i]];
                });

                let newCases=[]
                //finding countries with the first ever cases
                function SelectNewCases(){
                    for (p=0; p<zippedNewCasesAndLabels.length; p++) {
                        if ((zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="US") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Mainland China")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="China") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Canada") &&
                            (zippedNewCasesAndLabels[p][1]=="First Case"  && zippedNewCasesAndLabels[p][0]!="Australia")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="France")
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="United Kingdom" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Netherlands" )
                            && (zippedNewCasesAndLabels[p][1]=="First Case" && zippedNewCasesAndLabels[p][0]!="Denmark" )) {
                            newCases.push(zippedNewCasesAndLabels[p][0])
                        }

                    }

                }
                SelectNewCases()
                //if there is no new country
                if (newCases.length==0) {
                    newCases.push("N/A for today")
                }
                let newCasesString="";
                function newCasesToString(){
                    for (i=0; i<newCases.length;i++){
                        newCasesString+=newCases[i]
                        if (newCases[i+1]){
                            newCasesString+=" - "
                        }
                        else {
                            newCasesString+=""
                        }
                    }
                }
                newCasesToString()
                //slice countries with the top five % daily change from top
                let topFive=[]
                function selectTopFive() {
                    topFive=zippedPercDailyChange.slice(0,5)
                }
                selectTopFive()
                //find the today's cases for corresponding country from the topFive list
                let toRecovered=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<c.length;n++){
                            if(topFive[i][0]==c[n][0]){
                                toRecovered.push(c[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas.length;m++){
                            if(topFive[i][0]==cStatesOverSeas[m][0] ) {
                                toRecovered.push(cStatesOverSeas[m][1])
                            }
                        }
                    }
                }


                //find the yesterday's recovered for corresponding country from the topFive list
                let fromRecovered=[]
                for (i=0;i<topFive.length;i++){
                    if (topFive[i][0]!="Denmark" && topFive[i][0]!="France" && topFive[i][0]!="United Kingdom" && topFive[i][0]!="Netherlands") {
                        for(n=0;n<cYes.length;n++){
                            if(topFive[i][0]==cYes[n][0]){
                                fromRecovered.push(cYes[n][1])
                            }
                        }
                    } else {
                        for (m=0;m<cStatesOverSeas_OneDayAgo.length;m++){
                            if(topFive[i][0]==cStatesOverSeas_OneDayAgo[m][0] ) {
                                fromRecovered.push(cStatesOverSeas_OneDayAgo[m][1])
                            }
                        }
                    }
                }

                //put them in a format that will be displayed properly to the user
                let topFiveString="";
                function createString(){
                    for (v=0;v<topFive.length;v++){
                        topFiveString+=topFive[v][0]
                        topFiveString+=" "
                        topFiveString+=topFive[v][1]
                        if (topFive[v+1]){
                            topFiveString+="% - from "+fromRecovered[v]+" to "+ toRecovered[v]+ "</br> "
                        } else {
                            topFiveString+="% - from "+fromRecovered[v]+" to "+toRecovered[v]
                        }
                    }
                }
                createString()
                //push the values the document
                document.getElementById("firstRecovered").innerHTML="<b>Countries that most recently announced the first recovered within their borders:</b> "+"</br>"+newCasesString
                document.getElementById("topFiveRecovered").innerHTML="<b>Countries with the highest daily % change in recovered: </b> "+"</br>"+topFiveString




                ////Graphs for recovered cases
                Highcharts.chart('containerBarRecovered', {
                    chart: {
                        type: 'bar'
                    },
                    
   
                    
                    title: {
                        text: 'Recovered'
                    },
                    subtitle: {
                        text: 'Total Recovered by Country'
                    },
                    xAxis: {
                        categories: sortedRecoveredLabels,
                        title: {
                            text: null
                        }
                    },
                    yAxis: {
                        min: 0,
                        title: {
                            text: 'Number of Persons',
                            align: 'high'
                        },
                        labels: {
                            overflow: 'justify'
                        }
                    },
                    tooltip: {
                        valueSuffix: ' '
                    },
                    plotOptions: {
                        bar: {
                            dataLabels: {
                                enabled: true
                            }
                        }
                    },
                    /*legend: {
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'top',
                        x: -40,
                        y: 80,
                        floating: true,
                        borderWidth: 1,
                        backgroundColor:
                            Highcharts.defaultOptions.legend.backgroundColor || '#FFFFFF',
                        shadow: true
                    },*/
                    credits: {
                        enabled: false
                    },
                    series: [{
                        name: 'Recovered',
                        data:sortedRecoveredValues,
                        color: '#2b8cbe'
                    }]
                });

                

                //Line chart
                Highcharts.chart('containerLineRecovered', {
                    title: {
                        text: 'Growth of Recovered by Country'
                    },
                    subtitle: {
                        text: 'Starting Date:1/22/20'
                    },
                    credits: {
                        enabled: false
                    },
        
                    yAxis: {
                        title: {
                            text: 'Persons'
                        }
                    },
                    xAxis: {
                        categories: timeSeriesRecoveredLabels[0]
                    },
                    legend: {
                        itemStyle: {
                            fontSize:"9px"
                        },
                        layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle'
                    },
                    tooltip: {
                        style:{


                            fontSize:"9px",
                        },
                        split: true,
                        distance: 5,
                        padding: 1
                    },
                    plotOptions: {
                        series: {
                            label: {
                                connectorAllowed: false
                            },
                            pointStart: 0
                        }
                    },
                    series: [{
                        name: 'UK',
                        data: timeSeriesRecovered_UK[0]
                    }, {
                        name: 'France',
                        data: timeSeriesRecovered_France[0]
                    },{
                        name: 'Turkey',
                        data: timeSeriesRecovered_Turkey[0]
                    },{
                        name: 'Germany',
                        data: timeSeriesRecovered_Germany[0]
                    },{
                        name: 'South Korea',
                        data: timeSeriesRecovered_SouthKorea[0]
                    },{
                        name: 'Spain',
                        data: timeSeriesRecovered_Spain[0]
                    },{
                        name: 'Italy',
                        data: timeSeriesRecovered_Italy[0]
                    },{
                        name: 'Iran',
                        data: timeSeriesRecovered_Iran[0]
                    },{
                        name: 'Switzerland',
                        data: timeSeriesRecovered_Switzerland[0]
                    }
                        ,{
                            name: 'US',
                            data: timeSeriesRecovered_US_Total
                        }
                        ,{
                            name: 'Canada',
                            data: timeSeriesRecovered_Canada_Total
                        },{
                            name: 'Australia',
                            data: timeSeriesRecovered_Australia_Total
                        },{
                            name: 'China',
                            data: timeSeriesRecovered_China_Total
                        },{
                            name: 'Czechia',
                            data: timeSeriesRecovered_Czechia[0]
                        },{
                            name: 'Netherlands',
                            data: timeSeriesRecovered_NL[0]
                        }],
                        

                    responsive: {
                        rules: [{
                            condition: {
                                maxWidth: 500
                            },
                            chartOptions: {
                                legend: {
                                    layout: 'horizontal',
                                    align: 'center',
                                    verticalAlign: 'bottom'
                                }
                            }
                        }]
                    },

                    /*annotations: [{
        labelOptions: {
           backgroundColor: 'rgba(255,255,255,0.5)',
            verticalAlign: 'top',
            y: 15
        },
        labels: [{
            point: {
                xAxis: 0,
                yAxis: 0,
                x: '5',
                y: 25000
            },
            text: 'Arbois'
        }] }],*/
                });

            },

        });


    };

</script>
</body>
</html>